# üìä Telegram Channel Analytics Bot - Enterprise Edition

–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –±–æ—Ç –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ Telegram –∫–∞–Ω–∞–ª–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö, –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π –æ—Ç—á–µ—Ç–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–æ–π —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

## üåü –ö–ª—é—á–µ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üìà –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- **–ú–Ω–æ–≥–æ–∫–∞–Ω–∞–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–∞–Ω–∞–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ** - –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∞–Ω–∞–ª–∏–∑–∞ —Ç—Ä–µ–Ω–¥–æ–≤ –∑–∞ –ª—é–±–æ–π –ø–µ—Ä–∏–æ–¥
- **–í–Ω–µ—à–Ω–∏–µ API** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telemetr.me –∏ TGStat.ru –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- **–ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏** - –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –∏ engagement rate

### üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –æ—Ç—á–µ—Ç—ã
- **Matplotlib –≥—Ä–∞—Ñ–∏–∫–∏** - –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã —Ä–æ—Å—Ç–∞, –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤, —Å—Ä–∞–≤–Ω–µ–Ω–∏–π
- **CSV —ç–∫—Å–ø–æ—Ä—Ç** - –ø–æ–ª–Ω–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ —É–¥–æ–±–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç—á–µ—Ç—ã** - –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –∏ –º–µ—Å—è—á–Ω—ã–µ —Å–≤–æ–¥–∫–∏ –ø–æ email/Telegram
- **–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** - –∞–Ω–∞–ª–∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

### üîî –£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–∑–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –º–µ—Ç—Ä–∏–∫ (¬±20% –ø–æ–¥–ø–∏—Å—á–∏–∫–∏, -30% –ø—Ä–æ—Å–º–æ—Ç—Ä—ã)
- **–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–æ—Ä–æ–≥–∏** - –≥–∏–±–∫–∏–µ —É—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏** - —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –Ω–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
- **APScheduler** - –Ω–∞–¥–µ–∂–Ω—ã–π –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç—á–µ—Ç–æ–≤
- **–ú–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ –∑–∞–¥–∞—á–∏** - –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ (02:00), –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ (–ø–Ω 04:00), –º–µ—Å—è—á–Ω—ã–µ (1 —á–∏—Å–ª–æ 05:00)
- **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –∑–∞–¥–∞—á

## üèóÔ∏è –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
- **Python 3.11+** —Å async/await
- **aiogram 3.x** –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ API Telegram Bot
- **SQLAlchemy 2.x** —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º ORM
- **PostgreSQL** —Å JSONB –¥–ª—è –≥–∏–±–∫–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è
- **Alembic** –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- **Pydantic** –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
src/
‚îú‚îÄ‚îÄ config.py              # Centralized Pydantic settings
‚îú‚îÄ‚îÄ bot/                   # Main bot class with dependency injection
‚îú‚îÄ‚îÄ collectors/            # Data collection abstraction
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py       # BaseCollector with rate limiting
‚îÇ   ‚îú‚îÄ‚îÄ telegram_collector.py    # Telethon integration
‚îÇ   ‚îî‚îÄ‚îÄ external_collectors.py   # Telemetr.me, TGStat.ru APIs
‚îú‚îÄ‚îÄ db/                    # Database layer
‚îÇ   ‚îî‚îÄ‚îÄ models.py         # SQLAlchemy models with proper relations
‚îú‚îÄ‚îÄ scheduler/             # Task automation
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py       # APScheduler service with health monitoring
‚îú‚îÄ‚îÄ reports/               # Report generation
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py       # Matplotlib chart generation
‚îÇ   ‚îî‚îÄ‚îÄ export_service.py # Multi-format data export
‚îú‚îÄ‚îÄ handlers/              # Bot command handlers
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py       # Admin-protected commands with inline keyboards
‚îî‚îÄ‚îÄ utils/
    ‚îî‚îÄ‚îÄ logging.py        # Structured JSON logging with Sentry
```

## üöÄ Production Deployment

### Railway (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**
   ```bash
   git clone <your-repo>
   cd TG-analiz
   ```

2. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   ```env
   # Essential
   BOT_TOKEN=1234567890:AAEhBOweik9-w7h_SeHh5JdwFhxQ6t5T6q4
   ADMIN_USER_ID=123456789
   DATABASE_URL=postgresql://user:pass@hostname:5432/db
   
   # Telegram API (–¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö)
   API_ID=12345678
   API_HASH=abcdef1234567890abcdef1234567890
   
   # External APIs (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   TELEMETR_API_KEY=your_telemetr_key_here
   TGSTAT_API_KEY=your_tgstat_key_here
   
   # Monitoring (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
   SENTRY_DSN=https://your-sentry-dsn
   
   # Scheduler timing (UTC)
   DAILY_COLLECT_HOUR=2
   WEEKLY_REPORT_DAY=0
   MONTHLY_REPORT_DAY=1
   ```

3. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**
   ```bash
   python scripts/init_db.py
   python main_v2.py
   ```

### Docker —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

```bash
# Build and run
docker build -t telegram-analytics .
docker run -d --env-file .env -p 8000:8000 telegram-analytics

# Health check
curl http://localhost:8000/health
```

## üîß –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ö–æ–º–∞–Ω–¥—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

- `/add @channel_username` - –î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- `/remove @channel_username` - –£–¥–∞–ª–∏—Ç—å –∫–∞–Ω–∞–ª
- `/list` - –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –∫–∞–Ω–∞–ª—ã
- `/stats @channel_username [days]` - –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥
- `/export @channel_username [csv|json]` - –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
- `/health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
- `/alerts configure` - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã

- `/start` - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
- `/help` - –°–ø—Ä–∞–≤–∫–∞ –ø–æ –¥–æ—Å—Ç—É–ø–Ω—ã–º –∫–æ–º–∞–Ω–¥–∞–º

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ö–µ–º–∞

```sql
-- –ö–∞–Ω–∞–ª—ã —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
channels (id, channel_id, username, title, description, is_active, created_at)

-- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
members_daily (channel_id, date, members_count, members_growth, collected_at)

-- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤  
views_daily (channel_id, date, avg_views, total_views, posts_count, collected_at)

-- –î–µ—Ç–∞–ª–∏ –ø–æ—Å—Ç–æ–≤ –¥–ª—è –≥–ª—É–±–æ–∫–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
posts (channel_id, post_id, text, views, forwards, reactions, posted_at)

-- –£–ø–æ–º–∏–Ω–∞–Ω–∏—è –º–µ–∂–¥—É –∫–∞–Ω–∞–ª–∞–º–∏
mentions (channel_id, mentioned_channel_id, post_id, mention_type, context)

-- –û—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
quality_scores (channel_id, date, quality_score, engagement_rate, activity_score)

-- –û—á–µ—Ä–µ–¥—å –æ—Ç—á–µ—Ç–æ–≤ –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
reports_queue (report_type, channel_id, parameters, status, result_data)
```

### –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- –°–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ `(channel_id, date)` –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- B-tree –∏–Ω–¥–µ–∫—Å—ã –Ω–∞ `username`, `is_active`, `status`
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

## üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á

| –ó–∞–¥–∞—á–∞ | –í—Ä–µ–º—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|--------|----------|
| **–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π —Å–±–æ—Ä** | 02:00 UTC | –ü–æ–¥–ø–∏—Å—á–∏–∫–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä—ã, –Ω–æ–≤—ã–µ –ø–æ—Å—Ç—ã |
| **–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã** | –ü–Ω 04:00 UTC | –°–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞ –Ω–µ–¥–µ–ª—é |
| **–ú–µ—Å—è—á–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞** | 1 —á–∏—Å–ª–æ 05:00 UTC | –ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞ –º–µ—Å—è—Ü |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤** | –ö–∞–∂–¥—ã–µ 30 –º–∏–Ω | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Ä–æ–≥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π |

### Health Monitoring

- **HTTP endpoint** `/health` –¥–ª—è Railway health checks
- **Structured logging** —Å JSON —Ñ–æ—Ä–º–∞—Ç–æ–º –¥–ª—è ELK —Å—Ç–µ–∫–∞
- **Sentry integration** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- **Graceful shutdown** —Å proper cleanup —Ä–µ—Å—É—Ä—Å–æ–≤

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

### –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞
- **Admin-only commands** –ø—Ä–æ–≤–µ—Ä–∫–∞ ADMIN_USER_ID –¥–ª—è –≤—Å–µ—Ö —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö –∫–æ–º–∞–Ω–¥
- **Input validation** Pydantic —Å—Ö–µ–º—ã –¥–ª—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **SQL injection protection** —á–µ—Ä–µ–∑ SQLAlchemy ORM

### Rate Limiting –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- **API rate limiting** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è Telegram API
- **Retry mechanisms** —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö
- **Circuit breaker** –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–Ω–µ—à–Ω–∏—Ö API
- **Graceful error handling** –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –±–µ–∑ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–æ—Ç–∞

### Backup –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- **Database migrations** –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã —á–µ—Ä–µ–∑ Alembic
- **Configuration as code** –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ environment variables
- **Stateless design** –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

## üìà Performance –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- **Bulk inserts** –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
- **Connection pooling** —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ PostgreSQL
- **Lazy loading** –æ—Ç–ª–æ–∂–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- **Query optimization** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ EXPLAIN –ø–ª–∞–Ω–æ–≤

### –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –í—Ä–µ–º—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å –æ–¥–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞: ~2-3 —Å–µ–∫—É–Ω–¥—ã
- –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å: 100+ –∫–∞–Ω–∞–ª–æ–≤ –∑–∞ 5 –º–∏–Ω—É—Ç
- –†–∞–∑–º–µ—Ä –ë–î: ~1MB –Ω–∞ –∫–∞–Ω–∞–ª –≤ –º–µ—Å—è—Ü –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- Memory footprint: ~50-100MB RAM

## üß™ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

```bash
# Setup
git clone <repo>
cd TG-analiz
python -m venv venv
source venv/bin/activate  # Linux/Mac
pip install -r requirements.txt

# Environment
cp .env.example .env
# Edit .env with your values

# Database
python scripts/init_db.py
alembic upgrade head

# Run
python main_v2.py
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# Unit tests
pytest tests/ -v

# With coverage
pytest --cov=src tests/

# Integration tests
pytest tests/integration/ -v
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–æ–≤

```python
from src.collectors import BaseCollector

class NewAPICollector(BaseCollector):
    def __init__(self, api_key: str):
        super().__init__(rate_limit=1.0)  # 1 request per second
        self.api_key = api_key
    
    async def collect_channel_data(self, channel_id: int) -> Dict:
        async with self.rate_limiter:
            # Your collection logic
            return {"members": 1000, "views": 5000}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π

```bash
# –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
alembic revision --autogenerate -m "Add new analytics table"

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
alembic upgrade head

# –û—Ç–∫–∞—Ç
alembic downgrade -1
```

## üéØ Production Checklist

### –ü–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º

- [ ] ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL —Å–æ–∑–¥–∞–Ω–∞
- [ ] ‚úÖ Telegram Bot —Ç–æ–∫–µ–Ω –ø–æ–ª—É—á–µ–Ω –æ—Ç @BotFather
- [ ] ‚úÖ API credentials –ø–æ–ª—É—á–µ–Ω—ã –æ—Ç my.telegram.org
- [ ] ‚úÖ ADMIN_USER_ID —É–∫–∞–∑–∞–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] ‚úÖ Health endpoint –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ `/health`

### –ü–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

- [ ] ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π –∫–∞–Ω–∞–ª: `/add @channel_name`
- [ ] ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö: `/stats @channel_name`
- [ ] ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã: `/alerts configure`
- [ ] ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ Sentry/Railway

## üÜò Troubleshooting

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**"Database connection failed"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ DATABASE_URL —Ñ–æ—Ä–º–∞—Ç: `postgresql://user:pass@host:port/db`
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ PostgreSQL –¥–æ—Å—Ç—É–ø–µ–Ω

**"Bot API error 401"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ BOT_TOKEN –æ—Ç @BotFather
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –±–æ—Ç –Ω–µ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

**"Channel not found"**
- –î–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –≤ –∫–∞–Ω–∞–ª –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—á–Ω—ã–π @username –∫–∞–Ω–∞–ª–∞

**"Telethon auth error"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ API_ID –∏ API_HASH –æ—Ç my.telegram.org
- –ü—Ä–æ–π–¥–∏—Ç–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ Telethon session

### –õ–æ–≥–∏ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

```bash
# Railway logs
railway logs --tail

# Local logs
tail -f logs/bot.log

# Health check
curl https://your-app.railway.app/health
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

- **GitHub Issues** –¥–ª—è –±–∞–≥–æ–≤ –∏ feature requests
- **Logs monitoring** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Sentry
- **Health monitoring** Railway automatic restarts –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏
- **Documentation** –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ –∫–æ–¥–µ

---

**üöÄ Enterprise-ready Telegram Analytics Bot**

*–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã 24/7 —Å –ø–æ–ª–Ω—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º.*
